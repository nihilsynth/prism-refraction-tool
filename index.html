<!doctype html><html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width,initial-scale=1'><title>Prism Solver v4</title>
<style>
body{font-family:Arial;background:#f6f7fb;margin:0;padding:14px}
.card{max-width:980px;margin:auto;background:#fff;padding:16px;border-radius:10px;box-shadow:0 8px 24px rgba(0,0,0,.1);overflow:hidden}
.row{display:grid;grid-template-columns:minmax(0,1fr) 120px;gap:10px;margin:8px 0;align-items:center}
input{padding:8px;border:1px solid #bbb;border-radius:6px;width:100%;min-width:0}
button{padding:10px 14px;border:0;border-radius:8px;background:#2d6df6;color:#fff;font-weight:700;cursor:pointer;margin-right:8px}
.muted{color:#666;font-size:13px}
.ok{background:#e8f7e8;border-left:4px solid #3aa14a;padding:10px;margin-top:10px;display:none}
.err{background:#ffeaea;border-left:4px solid #d33;padding:10px;margin-top:10px;display:none}
.calc{background:#eef8ee;font-weight:700}
.grid{display:grid;grid-template-columns:1.1fr 1fr;gap:18px}
@media(max-width:900px){.grid{grid-template-columns:1fr}}
@media(max-width:640px){
  body{padding:8px}
  .card{padding:12px}
  .row{grid-template-columns:1fr;gap:6px}
  .row label{font-size:15px}
  button{width:100%;margin:0 0 8px 0}
}
svg{width:100%;height:auto;border:1px solid #ddd;border-radius:8px;background:#fafafa}
.eq{background:#f9fbff;border:1px solid #dbe6ff;border-radius:8px;padding:10px;margin-top:10px;font-size:14px;line-height:1.5}
.eq h4{margin:0 0 6px;color:#244}
code{background:#eef2ff;padding:1px 5px;border-radius:4px}
</style>
</head><body><div class='card'>
<h2>Prism Refraction Solver (Exam Labels)</h2><p class='muted'>Cross-referenced to your diagram notation: <b>i₁, r₁, r₂, i₂, A, n</b>. Enter known values, press <b>Update</b>.</p>
<div class='grid'>
<div>
<svg viewBox='0 0 700 480' aria-label='Prism diagram'>
<defs><marker id='arr' markerWidth='10' markerHeight='7' refX='9' refY='3.5' orient='auto'><polygon points='0 0,10 3.5,0 7' fill='#333'/></marker></defs>
<polygon points='350,70 560,390 140,390' fill='#dff0ff' stroke='#2e5eaa' stroke-width='3'/>
<line x1='40' y1='220' x2='250' y2='260' stroke='#2b66ff' stroke-width='4' marker-end='url(#arr)'/>
<line x1='250' y1='260' x2='450' y2='260' stroke='#2ca24a' stroke-width='4' marker-end='url(#arr)'/>
<line x1='450' y1='260' x2='650' y2='300' stroke='#e23b3b' stroke-width='4' marker-end='url(#arr)'/>
<line x1='250' y1='170' x2='250' y2='350' stroke='#777' stroke-width='2' stroke-dasharray='8 8'/>
<line x1='450' y1='170' x2='450' y2='350' stroke='#777' stroke-width='2' stroke-dasharray='8 8'/>
<text x='205' y='238' fill='#2b66ff' font-size='28' font-weight='700'>i₁</text>
<text x='285' y='246' fill='#2ca24a' font-size='28' font-weight='700'>r₁</text>
<text x='407' y='246' fill='#2ca24a' font-size='28' font-weight='700'>r₂</text>
<text x='480' y='286' fill='#e23b3b' font-size='28' font-weight='700'>i₂</text>
<text x='338' y='130' fill='#222' font-size='38' font-weight='700'>A</text>
<text x='175' y='378' fill='#2e5eaa' font-size='24' font-weight='700'>n</text>
<text x='515' y='378' fill='#2e5eaa' font-size='24' font-weight='700'>n'</text>
</svg>
<div class='eq'>
<h4>Base Equations</h4>
<div>1) <code>sin(i₁) = n · sin(r₁)</code></div>
<div>2) <code>A = r₁ + r₂</code></div>
<div>3) <code>n · sin(r₂) = sin(i₂)</code></div>
<div>4) <code>δ = i₁ + i₂ − A</code></div>
</div>
</div>
<div>
<div class='row'><label>i₁ (incident angle, °)</label><input id='i1' type='number' step='0.01' placeholder='40'></div>
<div class='row'><label>A (apical angle, °)</label><input id='A' type='number' step='0.01' placeholder='50'></div>
<div class='row'><label>n (refractive index)</label><input id='n' type='number' step='0.001' placeholder='1.58'></div>
<hr>
<div class='row'><label>r₁ (°)</label><input id='r1' readonly></div>
<div class='row'><label>r₂ (°)</label><input id='r2' readonly></div>
<div class='row'><label>i₂ (°)</label><input id='i2' readonly></div>
<div class='row'><label>δ total deviation (°)</label><input id='D' readonly></div>
<button onclick='solve()'>Update</button><button onclick='resetAll()' style='background:#888'>Reset</button>
<div id='ok' class='ok'></div><div id='err' class='err'></div>
<div id='worked' class='eq' style='display:none'></div>
</div>
</div>
</div>
<script>
function rad(d){return d*Math.PI/180} function deg(r){return r*180/Math.PI}
function by(id){return document.getElementById(id)}
function show(id,msg){by('ok').style.display='none';by('err').style.display='none';by(id).innerHTML=msg;by(id).style.display='block'}
function setv(id,v){var e=by(id);e.value=Number(v).toFixed(2);e.className='calc'}
function clearOut(){['r1','r2','i2','D'].forEach(k=>{by(k).value='';by(k).className=''})}
function solve(){clearOut(); by('worked').style.display='none';
  var i1=parseFloat(by('i1').value), A=parseFloat(by('A').value), n=parseFloat(by('n').value);
  if([i1,A,n].some(v=>Number.isNaN(v))){show('err','Enter i₁, A, n first.');return}
  if(n<=1){show('err','n must be > 1');return}

  var s1=Math.sin(rad(i1))/n; if(Math.abs(s1)>1){show('err','No real solution at first face.');return}
  var r1=deg(Math.asin(s1));
  var r2=A-r1; if(r2<=0){show('err','Invalid geometry: r₂ <= 0');return}
  var s2=n*Math.sin(rad(r2));
  if(Math.abs(s2)>1){setv('r1',r1);setv('r2',r2);show('err','Total internal reflection at second face.');return}
  var i2=deg(Math.asin(s2));
  var D=i1+i2-A;

  setv('r1',r1); setv('r2',r2); setv('i2',i2); setv('D',D);
  show('ok','✓ Solved');

  by('worked').innerHTML = `
    <h4>Worked Solution (from entered values)</h4>
    <div><b>Given:</b> i₁ = ${i1.toFixed(2)}°, A = ${A.toFixed(2)}°, n = ${n.toFixed(3)}</div>
    <div style='margin-top:6px'><b>r₁:</b> sin(r₁)=sin(${i1.toFixed(2)}°)/${n.toFixed(3)} = ${s1.toFixed(4)} ⇒ r₁=${r1.toFixed(2)}°</div>
    <div><b>r₂:</b> r₂ = A − r₁ = ${A.toFixed(2)} − ${r1.toFixed(2)} = ${r2.toFixed(2)}°</div>
    <div><b>i₂:</b> sin(i₂)=${n.toFixed(3)}·sin(${r2.toFixed(2)}°) = ${s2.toFixed(4)} ⇒ i₂=${i2.toFixed(2)}°</div>
    <div><b>δ:</b> δ = i₁ + i₂ − A = ${i1.toFixed(2)} + ${i2.toFixed(2)} − ${A.toFixed(2)} = <b>${D.toFixed(2)}°</b></div>
  `;
  by('worked').style.display='block';
}
function resetAll(){['i1','A','n','r1','r2','i2','D'].forEach(k=>{by(k).value='';by(k).className=''}); by('ok').style.display='none'; by('err').style.display='none'; by('worked').style.display='none';}
</script></body></html>